

<section id="calc-harris" style="max-width:500px;margin:auto;font-family:Inter,Arial,sans-serif;">
  <style>
    #calc-harris .box{
      background:#0f2333;
      color:#e6eef6;
      padding:25px;
      border-radius:16px;
      box-shadow:0 6px 18px rgba(0,0,0,0.5);
      text-align:center;
    }
    #calc-harris h2{
      font-size:1.4rem;
      line-height:1.5em;
      font-weight:800;
      margin-bottom:20px;
      color:#ffffff;
    }
    #calc-harris label{
      display:block;
      margin:10px 0 5px;
      font-weight:700;
      text-align:left;
    }
    #calc-harris input,#calc-harris select{
      width:100%;
      padding:10px;
      border:none;
      border-radius:8px;
      background:#2b4b62;
      color:#e6eef6;
      font-size:15px;
      box-sizing:border-box;
    }

    #calc-harris #calcular{
      width:100%;
      margin-top:14px;
      padding:12px;
      border:none;
      border-radius:10px;
      background:#6fb1ff;
      color:#05202a;
      font-weight:800;
      cursor:pointer;
      transition:0.3s;
      animation:pulse 2s infinite;
    }
    #calc-harris #calcular:hover{
      background:#8dc2ff;
      transform:scale(1.03);
    }

    @keyframes pulse{
      0%{box-shadow:0 0 0px rgba(111,177,255,0.4);}
      50%{box-shadow:0 0 15px rgba(111,177,255,0.8);}
      100%{box-shadow:0 0 0px rgba(111,177,255,0.4);}
    }

    #calc-harris .out{
      margin-top:18px;
      background:rgba(255,255,255,0.05);
      padding:15px;
      border-radius:10px;
      text-align:left;
    }
    #loadingBar{
      display:none;
      height:10px;
      width:0%;
      background:#6fb1ff;
      border-radius:5px;
      transition:width 2s ease;
      margin-top:15px;
    }

    #checkoutButton{
      display:none;
      margin-top:20px;
      background:#00ff99;
      color:#001a0f;
      border:none;
      border-radius:8px;
      padding:14px 20px;
      font-weight:900;
      cursor:pointer;
      width:100%;
      font-size:1.05rem;
      transition:0.3s;
      animation:glow 2.5s infinite;
    }
    #checkoutButton:hover{
      background:#33ffaa;
      transform:scale(1.05);
    }

    @keyframes glow{
      0%{box-shadow:0 0 6px #00ff99;}
      50%{box-shadow:0 0 20px #00ff99;}
      100%{box-shadow:0 0 6px #00ff99;}
    }

    #calc-harris .final-text{
      color:#b7fff1;
      font-style:italic;
      font-size:1.05rem;
      font-weight:700;
      text-align:center;
      margin-top:15px;
      text-shadow:0 0 10px rgba(183,255,241,0.8);
    }
  </style>

  <div class="box">
    <h2>Descubra sua estimativa de kcal para o seu objetivo inserindo seus dados na calculadora abaixo:</h2>

    <label for="peso">Peso (kg):</label>
    <input type="number" id="peso" placeholder="Ex: 70" min="30" max="250">

    <label for="altura">Altura (cm):</label>
    <input type="number" id="altura" placeholder="Ex: 167" min="100" max="230">

    <label for="idade">Idade (anos):</label>
    <input type="number" id="idade" placeholder="Ex: 30" min="10" max="120">

    <label for="genero">G√™nero:</label>
    <select id="genero">
      <option value="">Selecione...</option>
      <option value="m">Homem</option>
      <option value="f">Mulher</option>
    </select>

    <label for="atividade">N√≠vel de atividade:</label>
    <select id="atividade">
      <option value="">Selecione...</option>
      <option value="1.2">Sedent√°rio (pouco ou nenhum exerc√≠cio)</option>
      <option value="1.375">Leve (1‚Äì3 dias/semana)</option>
      <option value="1.55">Moderado (3‚Äì5 dias/semana)</option>
      <option value="1.725">Ativo (6‚Äì7 dias/semana)</option>
      <option value="1.9">Muito ativo (trabalho f√≠sico pesado)</option>
    </select>

    <label for="objetivo">Objetivo:</label>
    <select id="objetivo">
      <option value="">Selecione...</option>
      <option value="manter">Manter peso</option>
      <option value="emagrecer">Emagrecer (-20%)</option>
      <option value="ganhar">Ganhar massa (+15%)</option>
    </select>

    <button id="calcular">Calcular</button>

    <div id="loadingBar"></div>
    <div id="resultado" class="out" style="display:none;"></div>

    <button id="checkoutButton"></button>
  </div>

  <script>
    function arredondarParaCentenaMaisProxima(valor){
      const dezena = Math.floor((valor % 100) / 10);
      const base = Math.floor(valor / 100) * 100;
      return dezena >= 5 ? base + 100 : base;
    }

    document.getElementById("calcular").addEventListener("click", function(){
      const peso = parseFloat(document.getElementById("peso").value);
      const altura = parseFloat(document.getElementById("altura").value);
      const idade = parseFloat(document.getElementById("idade").value);
      const genero = document.getElementById("genero").value;
      const atividade = parseFloat(document.getElementById("atividade").value);
      const objetivo = document.getElementById("objetivo").value;
      const resultado = document.getElementById("resultado");
      const barra = document.getElementById("loadingBar");
      const btnCheckout = document.getElementById("checkoutButton");

      if(!peso || !altura || !idade || !genero || !atividade || !objetivo){
        resultado.style.display = "block";
        resultado.innerHTML = "<span style='color:#ffbaba'>Preencha todos os campos para calcular.</span>";
        btnCheckout.style.display = "none";
        return;
      }

      resultado.style.display = "none";
      btnCheckout.style.display = "none";
      barra.style.display = "block";
      barra.style.width = "0%";
      setTimeout(()=>{ barra.style.width = "100%"; },100);

      setTimeout(()=>{
        let bmr;
        if(genero === "m"){
          bmr = 88.362 + (13.397 * peso) + (4.799 * altura) - (5.677 * idade);
        } else {
          bmr = 447.593 + (9.247 * peso) + (3.098 * altura) - (4.330 * idade);
        }

        const tdee = bmr * atividade;
        let calorias = tdee;
        let descricao = "Manuten√ß√£o";

        if(objetivo === "emagrecer"){
          calorias = tdee * 0.8;
          descricao = "D√©ficit de -20% (emagrecimento)";
        } else if(objetivo === "ganhar"){
          calorias = tdee * 1.15;
          descricao = "Super√°vit de +15% (ganho de massa)";
        }

        const caloriasArredondadas = arredondarParaCentenaMaisProxima(calorias);

        const proteina = peso * 2;
        const gordura = peso * 0.9;
        const kcalProteina = proteina * 4;
        const kcalGordura = gordura * 9;
        const kcalCarbo = calorias - (kcalProteina + kcalGordura);
        const carbo = kcalCarbo / 4;

        barra.style.display = "none";
        resultado.style.display = "block";
        resultado.innerHTML = `
          <strong>Taxa Metab√≥lica Basal (BMR):</strong> ${Math.round(bmr)} kcal/dia<br>
          <strong>Gasto cal√≥rico total (TDEE):</strong> ${Math.round(tdee)} kcal/dia<br>
          <strong>Calorias para ${descricao}:</strong> ${caloriasArredondadas} kcal/dia<br><br>
          <strong>Macronutrientes sugeridos:</strong><br>
          ‚Ä¢ Prote√≠na: ${proteina.toFixed(1)} g<br>
          ‚Ä¢ Gordura: ${gordura.toFixed(1)} g<br>
          ‚Ä¢ Carboidrato: ${carbo.toFixed(1)} g<br><br>
          <p class="final-text">
            Pronto! Sua dieta est√° √† sua espera.<br>
            Com meu m√©todo baseado na ci√™ncia da nutri√ß√£o, voc√™ ter√° uma dieta personalizada especificamente para alcan√ßar seu objetivo.
          </p>
        `;

        // üî• NOVO LINK DO CHECKOUT AQUI:
        btnCheckout.style.display = "block";
        btnCheckout.textContent = `Quero minha dieta de ${caloriasArredondadas} kcal`;
        btnCheckout.onclick = () => {
          window.location.href = "https://pay.kiwify.com.br/hOCTYpe";
        };

      }, 2100);
    });
  </script>
</section>
